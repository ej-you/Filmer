# Чистая архитектура серверной части приложения Filmer


## Все содержимое

### `/server/cmd/app`
Точка входа для серверной части приложения.

### `/server/config`
Главный конфиг для работы сервера.

### `docs`
Сгенерированная Swager документация. А также доп. данные для документации проекта

### `internal`
Основная логика приложения. Не импортируется за пределы своего пакета.

### `migrations`
Миграции БД.

### `pkg`
Внешние зависимости, оформленные в виде интерфейсов, для использования в любой части приложения.

### `third_party`
Внешние дополнительные сервисы (в данном случае - Kinopoisk API клиент).


## Основная логика приложения

### `internal/app`
Содержит в себе интерфейс сервера и middleware менеджер для него.

### `internal/entity`
Содержит модели данных, используемые приложением.

> При этом в пакете `internal` отдельно содержатся пакеты для реализации действий с моделями данных.
> <br>
> Все эти пакеты построены по одной схеме, описанной в следующем разделе.


## Пакет для реализации действий с моделью данных

Каждый такой пакет содержит в себе интерфейсы:
1. Usecase
2. Repository (и/или его виды, такие как CacheRepository и KinopoiskWebAPI)

А также структуры, отвечающие за доставку данных:
1. HandlerManager
2. Router

### Интерфейсы

#### Usecase
Этот интерфейс содержит действия, которые можно совершать с моделью данных, к которому он привязан.
Все общения между пакетами с реализациями действий с моделями данных должны проходить только через этот интерфейс.

* реализуется в подпакете usecase

#### Repository
Этот интерфейс содержит методы для CRUD-оперирования данными модели.
В качестве репозитория могут выступать различные хранилища данных (БД, кэш, S3) или внешние API.

* реализуется в подпакете repository

> _!! Репозитории используются только внутри Usecase методов !!_

### Структуры

#### HandlerManager
Эта структура предоставляет все обработчики запросов (в данном проекте - HTTP), используя под капотом `Usecase` определённой модели.

* реализуется в подпакете delivery/http

> _!! `HandlerManager` инициализируется в интерфейсе сервера и используется структурой `Router` той же модели !!_

#### Router
Этот интерфейс позволяет настроить пути для доставки данных клиентам. В данном проекте для этого используется HTTP.
`Router` использует `HandlerManager` структуру для своей работы. `Router` настраивает эндпоинты для обработчиков из `HandlerManager`.

* реализуется в подпакете delivery/http

> _!! `Router` инициализируется в интерфейсе сервера при его запуске !!_
